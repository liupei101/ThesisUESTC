\chapter{乳腺癌复发预后模型应用}

\section{乳腺癌临床数据}
本章模型应用实验将使用来自四川大学华西医院乳腺疾病临床研究中心乳腺癌信息管理系统的真实数据，该信息管理系统回顾性收集了1989-2007年乳腺癌患者信息。自2008年起，该信息管理系统前瞻性登记所有在该院就诊的乳腺癌患者临床信息和预后信息。截止至2017年5月，乳腺癌信息管理系统总计登记患者12119例。从系统导出的原始数据包括患者的基本信息，诊断和病史，随访月经情况，病理，手术，化疗，放疗，内分泌治疗和靶向治疗记录。在华西医院就诊的乳腺癌患者，诊断日期分布在1989年到2017年之间。

本次模型应用中，我们以早期乳腺癌患者（I-III期）为研究对象，主要研究使用乳腺癌患者临床特征预测早期乳腺癌患者初次诊断后的复发情况。针对该研究目标，我们从乳腺癌信息管理系统中筛选了满足条件
\begin{enumerate}
	\item 初次诊断时，乳腺癌I-III期且无既往乳腺癌病史
	\item 初次诊断时，仅有单侧乳腺癌
\end{enumerate}
的乳腺癌患者，总计11522例。从信息管理系统导出的原始数据表包括基本信息，诊断和病史，病理信息，手术，化疗，放疗，内分泌治疗和靶向治疗记录，以及随访信息。我们需要检测原始临床数据中存在的缺失，异常，重复，不一致等问题，并且采取相应措施对原始临床数据进行清洗，以确保数据质量。同时，为了筛选标准的数据研究人群，以及生成并选择用于建立预测模型的临床特征，我们参考了四川大学华西医院乳腺疾病临床研究中心医学组给出的疾病专业知识，规则和建议。

最终，包含有15个乳腺癌临床特征的5293例早期乳腺癌患者记录以及他们对应的末次随访记录组成了本次模型应用研究的乳腺癌临床数据集 —— WCH。乳腺癌临床特征主要包括：个人基本信息，肿瘤病理信息，手术信息，化疗信息，放疗信息，内分泌治疗信息。数据统计显示，在230个月的随访时间内，整个数据集中有19.82\%的患者在初次诊断后出现了复发，而随访时间的最小值，中位数和最大值分别为1,89和230。使用Kaplan-Meier方法估计整个数据集人群总体的生存曲线，结果如图\ref{pic12}所示。从图\ref{pic12}中可以看出，在前200个月的随访时间内，数据集中早期乳腺癌患者的生存（未出现复发）率是平缓下降的，但总体维持较低的复发率；在200个月以后的随访时间内，人群总体的生存率基本维持不变。

\begin{figure}[H]
\includegraphics[width=0.9\textwidth]{pic12.png}
\caption{乳腺癌临床数据人群总体生存曲线}
\label{pic12}
\end{figure}

\section{乳腺癌预后模型}
为了建立针对早期乳腺癌患者的复发预后模型，我们将上述的乳腺癌临床数据集按照8:2的比例划分为了训练集和测试集。其中，训练集用于模型参数优化及模型训练，包含4234例患者记录，复发率为19.58\%；测试集用于评估模型的预测性能，包含1059例患者记录，复发率为20.77\%。同样地，我们检验了两个数据集的特征分布及生存状态的差异性，最终保证数据划分后的两个人群的分布无显著差异（P>0.05）。

基于第三章和第四章给出的实验结果，这里我们选择使用性能更加突出的HitBoost方法建立针对早期乳腺癌患者的复发预后模型。在超参数优化方面，我们对训练集数据使用贝叶斯超参数优化搜索方法得到了HitBoost模型的最佳超参数，超参数搜索优化的过程如图\ref{pic13}所示。从图\ref{pic13}中可以看出，在第36轮超参数搜索时（图中红点所示），模型在交叉验证集上的表现最佳。然后，我们使用该模型超参数拟合训练集得到了最终的HitBoost模型，用于早期乳腺癌患者初次诊断后复发预测。随着迭代次数的增加，模型在训练集和测试集上的表现如图\ref{pic14}所示。从图\ref{pic14}可以看出，模型在测试集上的表现最终趋于平稳，不存在训练集过拟合的现象。使用时间依赖的一致性指数td-CI作为模型性能的评估指标，最终的早期乳腺癌患者复发预测模型在独立测试集上的表现为0.72323，而同样在训练集上拟合过的CoxPH，CoxBoost，ThresReg和RSF模型在同一独立测试集上的表现分别为0.69354，0.68752，0.66792和0.70517。该实验结果进一步说明了，在缺乏先验知识或者生存数据分布未知的情况下，HitBoost方法在生存分析预测问题上更加有效和优越。这里经过训练集拟合的早期乳腺癌患者复发预后模型将用于后续的相关应用。

\begin{figure}[H]
\includegraphics[width=0.75\textwidth]{pic13.png}
\caption{乳腺癌复发预测模型的超参数搜索过程}
\label{pic13}
\end{figure}

\begin{figure}[H]
\includegraphics[width=0.8\textwidth]{pic14.png}
\caption{乳腺癌复发预测模型的学习曲线}
\label{pic14}
\end{figure}

\section{因子分析应用}
在完成上述早期乳腺癌患者复发预测模型的建立后，我们可以使用该预后模型来寻找对早期乳腺癌患者初次诊断后复发的重要影响因子，以及探究不同因子的影响模式。正如第二章所描述的，复杂的神经网络模型，如DeepSurv，DeepHit和DRSA，它们虽然具有强大的表达能力，但是在模型解释性方面确无能为力，无法用于发现与感兴趣事件相关的重要影响因子。而模型特征解释性在实际生存分析应用中通常是被要求的，这在一定程度上限制了这类拥有强大表达能力的神经网络模型在各个领域中的发展与应用。由于HitBoost方法基于多输出的梯度提升树，所以它可以充分利用相关的统计量，如节点分裂过程中用于寻找最佳分裂特征的高阶梯度值，去评估特征的重要性。

\begin{figure}[H]
\includegraphics[width=0.95\textwidth]{pic15.png}
\caption{早期乳腺癌患者临床特征重要性排序}
\label{pic15}
\end{figure}

在使用预后模型评估特征重要性的过程中，我们保持模型参数不变，将HitBoost模型在WCH训练集上重复了30次模型拟合，每次都使用不同的随机数种子。最后得到30组由预测模型给出的特征重要性评估分数，将特征按分数的平均值由大到小排序，得到排在前10的特征如图\ref{pic15}所示（图中特征名为简写）。预后模型给出的对早期乳腺癌患者复发最重要的影响因子依次为诊断年龄，肿瘤N分期，分子分型，肿瘤T分期，术后化疗类型，术后内分泌治疗类型，WHO分级，Ki67，是否放疗，诊断年份。而临床乳腺疾病研究中，肿瘤T分期和N分期是经过广泛认可的重要影响因素，这与早期乳腺癌患者复发预测模型给出的特征重要性排序基本一致。

在评估完对早期乳腺癌患者初次诊断后复发最为重要的影响因子后，我们一般会利用预后模型探究重要影响因子的影响模式，进而揭示临床因素是如何影响乳腺癌复发的。肿瘤T分期指肿瘤的大小，它是乳腺疾病研究中影响乳腺癌复发最为重要的临床特征之一。这里我们使用预后模型主要探究肿瘤T分期的影响模式。在我们的研究数据中，肿瘤T分期的类别有4种，分别为T=0或1，T=2，T=3和T=4。肿瘤T分期值越大，意味着肿瘤直径越大。在包含有1059例乳腺癌患者记录的测试集中，按照肿瘤T分期类别划分得到T=0或1的患者有373人，T=2的患者有577人，T=3的患者有73人，T=4的患者有36人。使用Kaplan-Meier方法估计四个肿瘤T分期子组人群实际生存曲线，结果如图\ref{pic16}所示。图\ref{pic16}直观地说明了早期乳腺癌患者肿瘤直径越大，总体发生复发的概率也会越大。并且T=3或4的早期乳腺癌患者在前5年（60个月）内发生复发的概率是随着时间不断上升的，这与临床经验是一致的。

\begin{figure}[H]
\includegraphics[width=0.95\textwidth]{pic16.png}
\caption{不同肿瘤T分期子组人群的实际生存曲线}
\label{pic16}
\end{figure}

由预后模型估计，各个肿瘤T分期子组在5年内复发概率的平均值分别为：0.13$\pm$0.09（T=0或1），0.17$\pm$0.12（T=2），0.34$\pm$0.19（T=3）和0.44$\pm$0.17（T=4）。具体地，我们展示了预后模型估计测试集不同肿瘤T分期子组内患者在5年内发生复发的概率值分布，其Swarm图如图\ref{pic17:a}所示，KDE图如图\ref{pic17:b}所示。从图\ref{pic17:a}可以看出，肿瘤T分期为0/1或2的患者，在5年内发生复发的概率估计值大多都偏小，不超过0.2，且该类型患者占了较大的比重，而肿瘤分期为3或4的患者在整个测试集人群中占了较小的比重，同时5年内发生复发的概率估计值的平均值相对较高。图\ref{pic17:b}给出的概率估计值分布的KDE密度图，也直观地说明了随着乳腺癌患者肿瘤直径的增大，预后模型估计的5年内出现复发的概率值总体上也会随之偏大。图中概率密度曲线重叠的区域说明了有其它因素（如诊断年龄，分子分型等）也影响着早期乳腺癌患者的复发，同时早期乳腺癌患者的复发有着复杂的影响模式。对于临床疾病研究经验中不太突出的影响因子，我们也可以利用类似的方法来探究其影响模式或发现潜在的生物标志物（biomarker），从而帮助研究者更好地认识和了解疾病，在疾病预防和控制方面制定针对性的措施。

\begin{figure}[h]
\centering 
\subfigure[Swarm图]{\label{pic17:a}
\includegraphics[width=0.48\textwidth]{pic17a.png}
}
\hspace{0.01\linewidth}
\subfigure[KDE图]{\label{pic17:b}
\includegraphics[width=0.45\textwidth]{pic17b.png}
}
\caption{不同肿瘤T分期患者5年复发概率估计值的分布情况可视化结果}
\label{pic17}
\end{figure}

\section{治疗推荐应用}
大多数的疾病预后模型常常会被用于治疗推荐，或风险量化评估。如Katzman等人 \citing{Katzman2018DeepSurv}建立的DeepSurv模型，它被用于构建推荐系统去给来自德国乳腺癌研究人群的患者提供治疗推荐，结果表明遵从系统推荐的激素治疗患者人群比未遵从系统推荐的激素治疗的患者人群存活时间要长，存活时间的中位数分别为40.099个月和31.770个月。这一定程度上说明了疾病预后模型在治疗推荐上的有效性。类似地，我们使用乳腺癌患者临床真实数据构建的针对早期乳腺癌患者的复发预后模型也可以用于治疗推荐，量化不同治疗方式下的复发风险差异，为研究者提供一定的参考。以内分泌治疗推荐为例，一般手术后采用了内分泌治疗的患者有以下几种治疗药物或治疗方式：AI（接受芳香化酶抑制剂治疗），SERM（接受他莫昔芬或托瑞米芬等选择性雌激素受体调节剂治疗），OFS（接受卵巢功能抑制）。我们的乳腺癌临床数据集中共有1736例患者未接受术后内分泌治疗，其余3557例患者存在以下四种类型的术后内分泌治疗方式：AI，SERM，AI+SERM，OFS+AI+SERM。

\begin{figure}[H]
\includegraphics[width=0.95\textwidth]{pic18.png}
\caption{不同术后内分泌治疗下患者的生存曲线，由乳腺癌复发预测模型给出。}
\label{pic18}
\end{figure}

我们使用构建好的早期乳腺癌患者复发预后模型来对患者的术后内分泌治疗方式进行探究。首先，我们选择了一例来自测试集的乳腺癌患者，该患者实际使用的术后治疗方式类型为AI，在第63个月发生复发；然后，我们尝试在不同术后内分泌治疗方式下，模型对该患者生存状况的估计结果，结果如图\ref{pic18}所示。复发预后模型估计该患者在AI，SERM，AI+SERM，和OFS+AI+SERM四种术后治疗方式下，5年内不发生复发的概率分别为0.82870，0.83443，0.83427和0.82859；而不使用任何内分泌治疗时，该患者5年内不发生复发的概率为0.80918。通过预后模型给出估计结果我们可以知道，如果该患者同时使用了SERM类型的内分泌治疗药物，则该患者5年内不发生复发的概率可以提高0.00557；但是如果该患者不进行内分泌治疗，该患者5年内发生复发的概率则会增加0.01952。所以，使用构建的复发预后模型，通过类似的治疗评估方法，临床乳腺疾病医生或研究者可以更加科学地评估不同治疗方式带来的影响，从而结合临床实际情况制定更好的治疗措施。

\section{本章小结}

本章主要介绍了在乳腺癌临床研究领域，我们提出的生存分析优化方法的实际应用。本章首先介绍了乳腺癌临床数据的基本情况，包括其基本统计信息，生存曲线，和数据处理流程等。然后，我们将表现较好的HitBoost生存分析方法，应用于建立针对早期乳腺癌患者的复发预测模型。在乳腺癌临床数据集上训练完复发预测模型后，我们重点讨论了模型在因子分析，和治疗推荐方面的应用。由于HitBoost方法具有一定的模型解释性，所以在因子分析方面，我们借助预后模型直接评估对乳腺癌复发有重要影响的因子，得到的结果与临床经验基本一致。同时，我们还借助预后模型探究了肿瘤T分期对乳腺癌复发的影响模式。另外，在治疗推荐方面，我们以乳腺癌患者内分泌治疗推荐为例，展示了使用预后模型来帮助治疗推荐和分析的过程。

实验结果显示，我们建立的早期乳腺癌患者初次诊断后复发预后模型，可以用于乳腺临床疾病生存研究或辅助诊疗。本文提出的基于梯度提升树的生存分析优化方法，考虑了模型预测性能，解释性及实用性。所以，它可以作为一种有效的方法用于各个领域的生存分析或预测。
