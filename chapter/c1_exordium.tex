\thesischapterexordium

\section{背景与意义}

生存分析，作为一个旨在预测个体在观测期发生某个特定事件概率的研究方向，在医疗健康和金融等领域中有着重要的应用，比如预测某种疾病患者在诊断后出现复发的概率，以及评估在金融交易活动中的各类风险等。这些应用往往需要借助某种生存分析方法建立预测模型来研究感兴趣的事件，并且寻找该事件与预测变量之间的复杂因果关系。不同于我们常见的分类和回归问题，生存分析问题的目标是在于研究感兴趣的事件发生在各个时间点上的概率分布，它有观测时间和对应观测事件状态这两个目标变量，而解决这一类问题的特定方法则是生存分析方法 \citing{Lawless2002Statistical}。

在实际应用中，特别是在临床疾病预后研究中，我们经常需要借助生存分析方法来分析和研究患者的随访数据（包括随访时间，随访患者状态和随访患者其它与疾病相关的信息），然后基于随访数据建立精准的、健壮的预后预测模型，从而辅助医生进行诊断和治疗或发现与疾病相关的重要影响因子。例如在乳腺癌疾病预后研究领域，生存分析方法发挥着必不可少的作用。使用生存分析方法建立的经典的预后预测模型——PREDICT \citing{Candido2017PREDICT}，Adjuvant Online \citing{David2011External} 和21Gene \citing{SparanoA2016gene}都在临床上被广泛应用，例如辅助医生科学地评估患者疾病复发风险，进而推荐恰当的治疗手段或措施，从而在一定程度上减轻患者的负担；或者分析某个与乳腺癌相关的基因表达对乳腺癌复发的影响，寻找与乳腺癌复发相关的重要影响因子。在其它机器故障分析或金融交易等领域，生存分析方法扮演着同样重要的角色。所以，无论是在临床疾病预后研究领域还是其它领域，如何保证生存预测模型的准确性和实用性成为了国内外研究者重点关注的课题。而生存分析方法又是生存预测模型建立过程中必不可少的理论支撑，所以研究如何优化生存分析方法的预测性能以及保证实用性具有重要的价值和现实意义。

\section{研究历史与现状}

传统的生存分析方法大多基于统计理论，它们通常把个体的风险函数作为主要的研究对象，然后对此风险函数做出某种假设来预测个体在不同时间点发生事件的概率。Cox比例风险模型 \citing{COX1972Regression}（Cox proportional hazard model），作为传统的生存分析方法，是生存分析领域非常经典的预测模型之一。它假设个体的风险函数与人群的基准风险函数之比是一个不随时间改变的常数。这个不随时间改变的常数是Cox比例风险模型的预测目标，被称为风险比例。另一种传统的生存分析方法，FHT首次命中时间模型 \citing{Lee2006Threshold, Lee2010Threshold}（First Hitting Time model），主要通过假设个体风险函数为一个服从特定分布的带参数的随机过程来预测特定事件发生时间的概率密度。传统的Cox比例风险模型和FHT首次命中时间模型都对个体风险函数的表达式作出了强假设，并且假定模型参数与预测变量之间的线性关系，使用链接函数来预测个体风险函数。基于传统的生存分析模型，一些新的生存分析方法主要在模型参数优化方法或模型惩罚项方面作出了改进，如CoxBoost \citing{coxboost}，CoxNet \citing{Goeman2010L1}以及FhtBoost \citing{Stikbakke2019fht}。一般来说，在未知的情况下，一旦个体风险函数违背了上述的模型假设，那么这些模型的性能就会得到下降。

近些年，许多经典的机器学习算法在各个领域都得到了迅速的发展，从而在原算法的基础上衍生出不同的变体，如CART，支持向量机，随机森林，以及梯度提升树等。类似地，在生存分析领域，这些经典的机器学习基本算法也得到了应用。比如一类基于支持向量机的生存分析方法 \citing{belle2007svm}，它通过优化生存分析中特定的损失函数来预测不同个体的风险排序，但是无法直接估计个体风险函数或生存函数。再比如一类以随机森林和梯度提升树为代表的基于决策树的方法，其中基于随机森林的生存分析方法是随机生存森林 \citing{Ishwaran2008Random}（Random Survival Forest），它在随机森林的框架下通过使用生存分析中特定的节点分裂指标以及叶子节点风险函数估计算法来达到生存分析的目的，同时不再遵循传统模型的相关假设，但是容易出现模型过拟合的现象。而梯度提升树 \citing{Ridgeway1999boost, Friedman2001gbm}（Gradient Boosting Decision Tree），作为决策树集成方法中的Boosting方法，在实际应用中是更为突出的 \citing{liping2012logit}。梯度提升方法的一种变体XGBoost（eXtreme Gradient Boosting） \citing{chen2016xgboost}，由陈天琦等人于2016年提出，它在原梯度提升方法的基础上，更加精确地近似损失函数并且加入能有效避免过拟合的正则化项，从而得到一种新的树节点分裂与叶子节点估计算法，该算法在很多分类和回归问题中都取得了State-Of-The-Art的结果。现有的基于梯度提升树的生存分析方法 \citing{Ridgeway2007gbm, Binder2008Allowing}，通常是通过优化和Cox比例风险模型相同的偏似然估计函数来训练生存预测模型，最后预测个体的风险比例，进而得到个体风险函数或生存函数的估计。这类基于梯度提升树的生存分析方法虽然仍然遵循风险比例的这一假设，但是它已经可以表征对数风险比例与协变量之间复杂的非线性关系。虽然其解释性不如以Cox比例风险模型为主的这一类线性模型，但是在实际应用中，它在个体风险函数和生存函数的预测准确度上有着明显的优势 \citing{Yang2014ml}。正是由于这一类基于梯度提升树的生存分析方法依然遵循比例风险的假设，所以导致模型的性能受到了影响。这些影响因素主要表现在两个方面，一是比例风险模型中优化目标函数，即偏似然估计函数，不够精确 \citing{Bradley1977The}；二是个体风险函数的估计形式是服从风险比例假设的。
    
类似地，很多深度学习的算法在最近几年也在生存分析领域得到了发展。最早，DeepSurv \citing{Katzman2018DeepSurv}在Cox比例风险假设下使用深度神经网络建立风险预测模型，用于乳腺癌预后个性化预测。同时其他一些基于DeepSurv的深度生存分析模型被应用到了相关或其他领域 \citing{Yousefi2017pre}，这一类的方法利用深度神经网络优秀的表征能力来建立对数风险比例与协变量之间复杂的非线性关系，但是它们依旧服从风险比例假设。后来，新的基于深度学习的生存分析方法——DeepHit \citing{lee2018deephit}和DRSA \citing{ren2019drsa}分别使用深度神经网络和循环神经网络来预测首次发生事件时间的概率分布。虽然它们都不再遵循传统生存分析方法对个体风险函数形式做出的一些假设，但是，正如我们所知道的，基于深度学习方法建立的模型往往需要大量的训练样本，并且需要仔细调节模型参数和训练神经网络模型，这会耗费大量时间；同时，复杂的神经网络模型是一个黑盒子，它缺乏对模型特征的解释性，无法用于发现与感兴趣事件相关的重要影响因子，而模型特征解释性在实际应用模型中通常是被要求的。例如在乳腺癌研究领域，Joseph A Sparano在基因表达影响乳腺癌复发工作中使用生存预测模型发现某个与乳腺癌相关的基因属于危险因子还是保护因子 \citing{SparanoA2016gene}。所以这些因素在一定程度上限制了复杂的神经网络模型在各个领域的应用和推广。

\section{主要贡献与创新}

针对现有生存分析方法存在的问题，我们分别在传统的Cox比例风险模型和FHT首次命中时间模型的基础上研究了基于梯度提升树的优化方法，提出了两种生存分析方法。

（1）基于FHT首次命中时间模型思想，运用多输出的梯度提升树，研究提出了HiBoost算法。该方法的贡献和创新体现在：
\begin{itemize}
    \item 该方法可直接预测感兴趣的事件在各发生时间点的概率分布；
    \item 引入生存分析相关的极大似然估计函数和凸函数近似的一致性指数函数作为联合目标优化函数，提高了预测性能；
    \item 该方法不再对个体风险函数的形式做出任何先验假设，提升了算法的应用场景；
    \item 作为决策树的拓展模型，该算法仍然具有一定的解释性，保证了模型的实用性。
\end{itemize}


（2）基于传统的Cox比例风险模型，使用单个输出的梯度提升树，研究提出了BecCox算法，该方法的贡献和创新体现在：
\begin{itemize}
    \item 该方法遵循比例风险假设，预测感兴趣的事件发生的风险比例，可广泛应用于传统Cox生存分析场景；
    \item 在目标函数上，使用相比之前更加精确的偏似然估计函数，并且添加凸函数近似的一致性指数来调整风险排序，从而缩小了目标函数给模型预测带来的偏差；
    \item 相比经典的Cox比例风险系列模型，该方法有着更好的风险预测性能。
\end{itemize}

（3）建立了乳腺癌复发风险的模型。我们将提出的方法应用来自四川大学华西医院乳腺临床研究中心的乳腺癌临床数据中，建立了预测乳腺癌患者初次诊断后复发风险的模型。该模型评估表明，我们提出的方法可以作为有效的生存分析方法用于医疗健康或相关领域，为特定事件的分析提供重要手段。

由于提出的两种生存分析方法都构建在XGBoost算法框架之上，所以它们可以充分利用该框架在各个方面的优势，如模型表征能力以及避免过拟合等 \citing{chen2016xgboost}。其次，在生存分析问题上，HitBoost不再依赖任何个体风险函数假设而是直接使用多输出的梯度提升树来预测事件发生随时间的概率分布，同时它保留了一定的模型特征解释性。在通常生存数据分布未知的情况下，相比依赖个体风险函数假设的生存分析方法，HitBoost方法性能会更佳。而BecCox方法作为一类基于比例风险假设的模型，它对个体风险函数以及生存函数的估计会非常直观。相比一类保留了风险比例假设的其他模型，BecCox方法使用更加精确的优化目标以及风险调整策略，这使得在某些特殊的生存数据场景（如多个个体同时发生事件）中，BecCox方法会更加具有优势。在四个公开生存数据集上的实验结果显示，我们提出的HitBoost方法比常用的生存分析方法有着更好的概率分布预测性能；BecCox方法相比一类基于风险比例假设的生存分析方法而言，能够更加精确地预测比例风险。

\section{论文的结构安排}

本论文的章节结构安排如下。首先，第二章介绍生存分析基础及相关工作，第三章将详细介绍提出的两种基于梯度提升树的生存分析优化方法。然后，第四章给出四个公开生存数据集的情况，第五章给出各个生存分析方法在公开数据集上的实验结果，包括实验设置，模型表现和样例分析。接着第六章将介绍提出的生存分析方法在乳腺癌复发预测中的应用。最后，论文第七章进行全文总结及展望。